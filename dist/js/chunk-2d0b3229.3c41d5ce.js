(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b3229"],{"26a0":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"search"},[r("Row",[r("Col",[r("Card",[r("Row",[e.currServer?r("div",[r("h2",[e._v("当前操作主服务器")]),r("h4",[e._v("服务器名称:"+e._s(e.currServer.name))]),r("h4",[e._v("服务器地址:"+e._s(e.currServer.address))]),r("h4",[e._v("服务器端口:"+e._s(e.currServer.port))])]):r("div",[r("h2",[e._v("还未选择操作主服务器")])]),r("hr"),r("br")]),r("Row",[r("Modal",{attrs:{title:e.dialogFormTitle,"mask-closable":!1,width:"50%"},model:{value:e.dialogFormVisible,callback:function(t){e.dialogFormVisible=t},expression:"dialogFormVisible"}},[r("Form",{attrs:{model:e.serverForm,"label-width":120}},[r("FormItem",{attrs:{label:"服务器名称"}},[r("Input",{attrs:{autocomplete:"off",placeholder:"请输入服务器名称"},model:{value:e.serverForm.name,callback:function(t){e.$set(e.serverForm,"name",t)},expression:"serverForm.name"}})],1),r("FormItem",{attrs:{label:"服务器地址"}},[r("Input",{attrs:{autocomplete:"off",placeholder:"请输入服务器地址ip或域名  例10.10.10.10 或 www.huai.com "},model:{value:e.serverForm.address,callback:function(t){e.$set(e.serverForm,"address",t)},expression:"serverForm.address"}})],1),r("FormItem",{attrs:{label:"端口"}},[r("Input",{attrs:{autocomplete:"off",placeholder:"请输入端口号，default_port:80"},model:{value:e.serverForm.port,callback:function(t){e.$set(e.serverForm,"port",t)},expression:"serverForm.port"}})],1)],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{on:{click:function(t){return e.hideAddDialog()}}},[e._v("取 消")]),r("Button",{directives:[{name:"show",rawName:"v-show",value:!e.isEdit,expression:"!isEdit"}],attrs:{type:"primary"},on:{click:function(t){return e.addServer()}}},[e._v("添加")]),r("Button",{directives:[{name:"show",rawName:"v-show",value:e.isEdit,expression:"isEdit"}],attrs:{type:"primary"},on:{click:function(t){return e.editServer()}}},[e._v("修改")])],1)],1)],1),r("Row",[r("Modal",{attrs:{title:"查看服务器组","mask-closable":!1,width:"1000px"},model:{value:e.viewDialogFormVisible,callback:function(t){e.viewDialogFormVisible=t},expression:"viewDialogFormVisible"}},[r("h2",[e._v("当前服务器")]),r("h4",[e._v("服务器名称:"+e._s(e.viewServer.name))]),r("h4",[e._v("服务器地址:"+e._s(e.viewServer.address))]),r("h4",[e._v("服务器端口:"+e._s(e.viewServer.port))]),r("h2",[e._v("当前子服务器列表")]),r("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:e.openAddDialogWithChildren}},[e._v("添加子服务器")]),r("Table",{ref:"table",attrs:{border:"",columns:e.columns,data:e.childrenData,sortable:"custom"}}),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{on:{click:function(t){return e.hideViewDialog()}}},[e._v("取 消")])],1)],1)],1),r("Row",{staticClass:"operation"},[r("Button",{directives:[{name:"show",rawName:"v-show",value:this.$route.meta.permTypes.includes("add"),expression:"this.$route.meta.permTypes.includes('add')"}],attrs:{type:"primary",icon:"md-add"},on:{click:e.openAddDialog}},[e._v("添加主服务器")]),r("Button",{directives:[{name:"show",rawName:"v-show",value:this.$route.meta.permTypes.includes("view"),expression:"this.$route.meta.permTypes.includes('view')"}],on:{click:e.getServerByPage}},[e._v("刷新")])],1),r("Row",[r("Alert",{attrs:{"show-icon":""}},[e._v("\n            已选择\n            "),r("span",{staticClass:"select-count"},[e._v(e._s(e.selectCount))]),e._v(" 项\n            "),r("a",{staticClass:"select-clear",on:{click:e.clearSelectAll}},[e._v("清空")])])],1),r("Row",[r("h2",[e._v("主服务器列表")]),r("Table",{ref:"table",attrs:{loading:e.loading,border:"",columns:e.columns,data:e.data,sortable:"custom"},on:{"on-sort-change":e.changeSort,"on-selection-change":e.changeSelect}})],1),r("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[r("Page",{attrs:{current:e.pageNumber,total:e.total,"page-size":e.pageSize,"page-size-opts":[10,20,50],size:"small","show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)],1)],1)],1)],1)},s=[],o=r("365c"),a={name:"serverManage",data:function(){var e=this;return{currServer:"",loading:!0,selectList:[],selectCount:0,dialogFormVisible:!1,viewDialogFormVisible:!1,dialogFormTitle:"",isEdit:!1,columns:[{type:"selection",width:60,align:"center"},{type:"index",width:60,align:"center"},{title:"服务器名称",key:"name",align:"center",width:150,sortable:!0},{title:"服务器地址",key:"address",align:"center",width:150,sortable:!0},{title:"端口",key:"port",align:"center",width:100},{title:"状态",key:"state",align:"center",width:100,sortable:!0,render:function(e,t){return 0==t.row.status?e("div",[e("Tag",{props:{color:"blue"}},"正常")]):-1==t.row.status?e("div",[e("Tag",{props:{color:"red"}},"弃用")]):void 0}},{title:"创建时间",key:"createTime",align:"center",width:180,sortable:!0,sortType:"desc"},{title:"更新时间",key:"updateTime",align:"center",width:180,sortable:!0},{title:"操作",key:"action",align:"center",width:300,render:function(t,r){var i="",s="",o=t("Button",{props:{type:"primary",size:"small",disabled:!e.$route.meta.permTypes.includes("edit")},style:{marginRight:"5px"},on:{click:function(){e.openEditDialog(r.row)}}},"编辑");i=0==r.row.status?t("Button",{props:{size:"small",disabled:!e.$route.meta.permTypes.includes("disable")},style:{marginRight:"5px"},on:{click:function(){e.disable(r.row)}}},"禁用"):t("Button",{props:{type:"success",size:"small",disabled:!e.$route.meta.permTypes.includes("enable")},style:{marginRight:"5px"},on:{click:function(){e.enable(r.row)}}},"启用");var a="";return"0"==r.row.parentId&&(s=t("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.openShowDialog(r.row)}}},"查看"),a=t("Button",{props:{type:"info",size:"small",disabled:e.currServer.id==r.row.id},style:{marginRight:"5px"},on:{click:function(){e.setDefault(r.row)}}},"设为操作服")),t("div",[s,o,i,a])}}],data:[],childrenData:[],serverForm:{name:"",address:"",port:"",parentId:"0"},viewServer:{},sortColumn:"createTime",sortType:"desc",pageNumber:1,pageSize:10,total:0}},methods:{init:function(){this.getServerByPage(),this.getDefault()},getServerByPage:function(){var e=this,t={pageNumber:this.pageNumber,pageSize:this.pageSize,sort:this.sortColumn,order:this.sort};this.loading=!0,Object(o["mb"])(t).then((function(t){e.loading=!1,t.success&&(e.data=t.result.records,e.total=t.result.total,(t.result.content||t.result.totalElements)&&(e.data=t.result.content,e.total=t.result.totalElements))}))},refresh:function(){this.viewDialogFormVisible?this.getServerListByParentId():this.getServerByPage()},addServer:function(){var e=this;this.checkFormData()&&Object(o["h"])(this.serverForm).then((function(t){t.success&&(e.hideAddDialog(),e.refresh())}))},editServer:function(){var e=this;this.checkFormData()&&Object(o["Pb"])(this.serverForm).then((function(t){t.success&&(e.hideAddDialog(),e.refresh())}))},checkFormData:function(){return this.serverForm.name?this.serverForm.address?(this.serverForm.port||(this.serverForm.port=80),!0):(this.$Message.error("请输入服务器地址"),!1):(this.$Message.error("请输入服务器名称"),!1)},clearSelectAll:function(){this.$refs.table.selectAll(!1)},changeSelect:function(e){this.selectList=e,this.selectCount=e.length},changePage:function(e){this.pageNumber=e,this.getServerByPage(),this.clearSelectAll()},changePageSize:function(e){this.pageSize=e,this.getServerByPage()},changeSort:function(e){this.sortColumn=e.key,this.sortType=e.order,"normal"==e.order&&(this.sortType=""),this.getServerByPage()},openAddDialog:function(){this.dialogFormTitle="添加服务器",this.serverForm={},this.serverForm.parentId="0",this.isEdit=!1,this.dialogFormVisible=!0},hideAddDialog:function(){this.dialogFormVisible=!1,this.refresh()},openAddDialogWithChildren:function(){this.openAddDialog(),this.dialogFormTitle="添加子服务器",this.serverForm.parentId=this.viewServer.id},hideViewDialog:function(){this.viewDialogFormVisible=!1,this.getServerByPage()},openShowDialog:function(e){this.viewServer=e,this.getServerListByParentId(),this.viewDialogFormVisible=!0},getServerListByParentId:function(){var e=this;Object(o["nb"])({parentId:this.viewServer.id}).then((function(t){t.success&&(e.childrenData=t.result)}))},openEditDialog:function(e){this.dialogFormTitle="修改服务器",this.isEdit=!0,this.serverForm=e,this.dialogFormVisible=!0},enable:function(e){var t=this;this.$Modal.confirm({title:"确认启用",content:"您确认要启用服务器 "+e.name+" ?",loading:!0,onOk:function(){Object(o["M"])({id:e.id}).then((function(e){t.$Modal.remove(),e.success&&(t.$Message.success("操作成功"),t.refresh())}))}})},disable:function(e){var t=this;this.$Modal.confirm({title:"确认禁用",content:"您确认要禁用服务器 "+e.name+" ?",loading:!0,onOk:function(){Object(o["A"])({id:e.id}).then((function(e){t.$Modal.remove(),e.success&&(t.$Message.success("操作成功"),t.refresh())}))}})},setDefault:function(e){var t=this;this.$Modal.confirm({title:"确认设置",content:"您确认要 "+e.name+" 为默认操作服务器?",loading:!0,onOk:function(){Object(o["Lb"])({id:e.id}).then((function(e){t.$Modal.remove(),e.success?t.$Message.success(e.message):t.$Message.error(e.message),t.getDefault()}))}})},getDefault:function(){var e=this;this.currServer="",Object(o["Y"])().then((function(t){t.success&&(e.currServer=t.result)}))}},mounted:function(){this.init()}},n=a,l=r("2877"),c=Object(l["a"])(n,i,s,!1,null,"58650601",null);t["default"]=c.exports}}]);