{"remainingRequest":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/thread-loader/dist/cjs.js!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/sys/log-manage/logManage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/sys/log-manage/logManage.vue","mtime":1574132205000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getLogListData, deleteLog, deleteAllLog } from \"@/api/index\";\nimport circleLoading from \"@/views/my-components/circle-loading.vue\";\nexport default {\n  name: \"role-manage\",\n  components: {\n    circleLoading: circleLoading\n  },\n  data: function data() {\n    var _this = this;\n\n    return {\n      loading: true,\n      operationLoading: false,\n      selectList: [],\n      selectCount: 0,\n      selectDate: null,\n      searchKey: \"\",\n      searchForm: {\n        type: 1,\n        pageNumber: 1,\n        pageSize: 10,\n        startDate: \"\",\n        endDate: \"\",\n        sort: \"createTime\",\n        order: \"asc\"\n      },\n      columns: [{\n        type: \"selection\",\n        width: 60,\n        align: \"center\",\n        fixed: \"left\"\n      }, {\n        type: \"index\",\n        width: 60,\n        align: \"center\",\n        fixed: \"left\"\n      }, {\n        title: \"操作名称\",\n        key: \"name\",\n        width: 110,\n        sortable: true,\n        fixed: \"left\"\n      }, {\n        title: \"请求类型\",\n        key: \"requestType\",\n        width: 120,\n        align: \"center\",\n        sortable: true,\n        filters: [{\n          label: \"GET\",\n          value: \"GET\"\n        }, {\n          label: \"POST\",\n          value: \"POST\"\n        }, {\n          label: \"PUT\",\n          value: \"PUT\"\n        }, {\n          label: \"DELETE\",\n          value: \"DELETE\"\n        }],\n        filterMultiple: false,\n        filterMethod: function filterMethod(value, row) {\n          if (value == \"GET\") {\n            return row.requestType == \"GET\";\n          } else if (value == \"POST\") {\n            return row.requestType == \"POST\";\n          } else if (value == \"PUT\") {\n            return row.requestType == \"PUT\";\n          } else if (value == \"DELETE\") {\n            return row.requestType == \"DELETE\";\n          }\n        }\n      }, {\n        title: \"请求路径\",\n        width: 150,\n        key: \"requestUrl\"\n      }, {\n        title: \"请求参数\",\n        minWidth: 200,\n        key: \"requestParam\",\n        tooltip: true\n      }, {\n        title: \"登录用户\",\n        key: \"username\",\n        width: 105,\n        sortable: true\n      }, {\n        title: \"IP\",\n        key: \"ip\",\n        width: 120,\n        sortable: true\n      }, {\n        title: \"IP信息\",\n        key: \"ipInfo\",\n        width: 100,\n        sortable: true\n      }, {\n        title: \"耗时(毫秒)\",\n        key: \"costTime\",\n        width: 130,\n        sortable: true,\n        align: \"center\",\n        filters: [{\n          label: \"≤1000毫秒\",\n          value: 0\n        }, {\n          label: \">1000毫秒\",\n          value: 1\n        }],\n        filterMultiple: false,\n        filterMethod: function filterMethod(value, row) {\n          if (value == 0) {\n            return row.costTime <= 1000;\n          } else if (value == 1) {\n            return row.costTime > 1000;\n          }\n        }\n      }, {\n        title: \"日志类型\",\n        key: \"logType\",\n        align: \"center\",\n        width: 120,\n        render: function render(h, params) {\n          if (params.row.logType == 0) {\n            return h(\"div\", [h(\"Tag\", {\n              props: {\n                color: \"blue\"\n              }\n            }, \"操作日志\")]);\n          } else if (params.row.logType == 1) {\n            return h(\"div\", [h(\"Tag\", {\n              props: {\n                color: \"green\"\n              }\n            }, \"登陆日志\")]);\n          } else if (params.row.logType == 2) {\n            return h(\"div\", [h(\"Tag\", {\n              props: {\n                color: \"green\"\n              }\n            }, \"游戏日志\")]);\n          }\n        }\n      }, {\n        title: \"创建时间\",\n        key: \"createTime\",\n        sortable: true,\n        width: 150,\n        sortType: \"asc\"\n      }, {\n        title: \"操作\",\n        key: \"action\",\n        width: 98,\n        align: \"center\",\n        fixed: \"right\",\n        render: function render(h, params) {\n          return h(\"div\", [h(\"Button\", {\n            props: {\n              type: \"error\",\n              size: \"small\",\n              disabled: !_this.$route.meta.permTypes.includes('delete')\n            },\n            on: {\n              click: function click() {\n                _this.remove(params.row);\n              }\n            }\n          }, \"删除\")]);\n        }\n      }],\n      data: [],\n      total: 0\n    };\n  },\n  methods: {\n    init: function init() {\n      this.getLogList();\n    },\n    changeTab: function changeTab(v) {\n      if (v == \"login\") {\n        this.searchForm.type = 1;\n      } else if (v == \"operation\") {\n        this.searchForm.type = 0;\n      } else if (v == \"game\") {\n        this.searchForm.type = 2;\n      }\n\n      this.getLogList();\n    },\n    changePage: function changePage(v) {\n      this.searchForm.pageNumber = v;\n      this.getLogList();\n      this.clearSelectAll();\n    },\n    changePageSize: function changePageSize(v) {\n      this.searchForm.pageSize = v;\n      this.getLogList();\n    },\n    selectDateRange: function selectDateRange(v) {\n      if (v) {\n        this.searchForm.startDate = v[0];\n        this.searchForm.endDate = v[1];\n      }\n    },\n    handleSearch: function handleSearch() {\n      this.searchForm.pageNumber = 1;\n      this.searchForm.pageSize = 10;\n      this.getLogList();\n    },\n    getLogList: function getLogList() {\n      var _this2 = this;\n\n      if (!this.$route.meta.permTypes.includes('view')) {\n        this.loading = false;\n        return;\n      }\n\n      this.loading = true;\n      this.searchForm.key = this.searchKey;\n      getLogListData(this.searchForm).then(function (res) {\n        _this2.loading = false;\n\n        if (res.success) {\n          _this2.data = res.result.records;\n          _this2.total = res.result.total;\n\n          if (res.result.content || res.result.totalElements) {\n            _this2.data = res.result.content;\n            _this2.total = res.result.totalElements;\n          }\n        }\n      });\n    },\n    handleReset: function handleReset() {\n      this.searchKey = \"\";\n      this.selectDate = null;\n      this.searchForm.startDate = \"\";\n      this.searchForm.endDate = \"\";\n      this.getLogList();\n    },\n    remove: function remove(v) {\n      var _this3 = this;\n\n      this.$Modal.confirm({\n        title: \"确认删除\",\n        content: \"您确认要删除该条数据?\",\n        loading: true,\n        onOk: function onOk() {\n          deleteLog(v.id).then(function (res) {\n            _this3.$Modal.remove();\n\n            if (res.success) {\n              _this3.$Message.success(\"删除成功\");\n\n              _this3.init();\n            }\n          });\n        }\n      });\n    },\n    clearSelectAll: function clearSelectAll() {\n      this.$refs.table.selectAll(false);\n    },\n    changeSelect: function changeSelect(e) {\n      this.selectList = e;\n      this.selectCount = e.length;\n    },\n    changeSort: function changeSort(e) {\n      this.searchForm.sort = e.key;\n      this.searchForm.order = e.order;\n\n      if (e.order == \"normal\") {\n        this.searchForm.order = \"\";\n      }\n\n      this.getLogList();\n    },\n    delAll: function delAll() {\n      var _this4 = this;\n\n      if (this.selectCount <= 0) {\n        this.$Message.warning(\"您还未选择要删除的数据\");\n        return;\n      }\n\n      this.$Modal.confirm({\n        title: \"确认删除\",\n        content: \"您确认要删除所选的 \" + this.selectCount + \" 条数据?\",\n        loading: true,\n        onOk: function onOk() {\n          var ids = \"\";\n\n          _this4.selectList.forEach(function (e) {\n            ids += e.id + \",\";\n          });\n\n          ids = ids.substring(0, ids.length - 1);\n          deleteLog(ids).then(function (res) {\n            _this4.$Modal.remove();\n\n            if (res.success) {\n              _this4.$Message.success(\"删除成功\");\n\n              _this4.clearSelectAll();\n\n              _this4.init();\n            }\n          });\n        }\n      });\n    },\n    clearAll: function clearAll() {\n      var _this5 = this;\n\n      this.$Modal.confirm({\n        title: \"请谨慎进行此操作！\",\n        content: \"您确认要彻底清空删除所有数据?\",\n        onOk: function onOk() {\n          _this5.loading = true;\n          var ids = \"\";\n\n          _this5.selectList.forEach(function (e) {\n            ids += e.id + \",\";\n          });\n\n          ids = ids.substring(0, ids.length - 1);\n          deleteAllLog().then(function (res) {\n            _this5.loading = false;\n\n            if (res.success) {\n              _this5.$Message.success(\"清空日志成功\");\n\n              _this5.clearSelectAll();\n\n              _this5.init();\n            }\n          });\n        }\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.init();\n  }\n};",null]}