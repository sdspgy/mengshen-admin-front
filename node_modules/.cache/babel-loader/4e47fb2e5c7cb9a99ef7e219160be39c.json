{"remainingRequest":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/game/miniUser/miniUser.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/game/miniUser/miniUser.vue","mtime":1577953537214},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { queryAllUser, getAllMiniRoleList, editMiniUser, getAllGame, editMiniUserGrant } from '@/api/index';\nexport default {\n  name: \"miniUser\",\n  data: function data() {\n    var _this = this;\n\n    return {\n      columns: [{\n        type: 'selection',\n        width: 60,\n        align: 'center',\n        fixed: 'left'\n      }, {\n        type: 'index',\n        width: 60,\n        align: 'center',\n        fixed: 'left'\n      }, {\n        title: 'openID',\n        key: 'openId',\n        width: 150\n      }, {\n        title: '微信名',\n        key: 'name',\n        width: 150\n      }, // {\n      //     title: '微信图片地址',\n      //     key: 'avatarUrl',\n      //     width: 300\n      // },\n      {\n        title: \"头像\",\n        key: \"avatarUrl\",\n        width: 80,\n        align: \"center\",\n        render: function render(h, params) {\n          return h(\"Avatar\", {\n            props: {\n              src: params.row.avatarUrl\n            }\n          });\n        }\n      }, {\n        title: '操作',\n        key: 'action',\n        width: 200,\n        align: 'center',\n        render: function render(h, params) {\n          var enableOrDisable = '';\n          var editButton = h('Button', {\n            props: {\n              type: 'primary',\n              size: 'small',\n              disabled: !_this.$route.meta.permTypes.includes('edit')\n            },\n            style: {\n              marginRight: '5px'\n            },\n            on: {\n              click: function click() {\n                _this.edit(params.row);\n              }\n            }\n          }, '角色分配');\n          var grantButton = h('Button', {\n            props: {\n              type: 'primary',\n              size: 'small',\n              disabled: !_this.$route.meta.permTypes.includes('add')\n            },\n            style: {\n              marginRight: '5px'\n            },\n            on: {\n              click: function click() {\n                _this.add(params.row);\n              }\n            }\n          }, '授权游戏');\n          return h('div', [editButton, grantButton]);\n        }\n      }],\n      data: [],\n      searchForm: {\n        name: '',\n        pageNumber: 1,\n        pageSize: 10\n      },\n      miniUserForm: [],\n      userForm: {\n        roles: []\n      },\n      gameForm: {\n        games: []\n      },\n      roleList: [],\n      modalType: 1,\n      modalTitle: '分配角色',\n      modalGrantTitle: '分配游戏',\n      ModalVisible: false,\n      ModalVisibleGrant: false,\n      total: 0,\n      submitLoading: false,\n      games: []\n    };\n  },\n  mounted: function mounted() {\n    this.init();\n    this.getRoleList();\n    this.getGames();\n  },\n  methods: {\n    init: function init() {\n      this.queryAll();\n    },\n    handleSearch: function handleSearch() {\n      this.queryAll();\n    },\n    queryAll: function queryAll() {\n      var _this2 = this;\n\n      queryAllUser(this.searchForm).then(function (res) {\n        if (res.success) {\n          _this2.data = res.msg.records;\n          _this2.total = res.count;\n        }\n      });\n    },\n    changePage: function changePage(v) {\n      this.searchForm.pageNumber = v;\n      this.queryAll();\n      this.clearSelectAll();\n    },\n    changePageSize: function changePageSize(v) {\n      this.searchForm.pageSize = v;\n      this.queryAll();\n    },\n    clearSelectAll: function clearSelectAll() {\n      this.$refs.table.selectAll(false);\n    },\n    edit: function edit(v) {\n      this.modalType = 1;\n      this.modalTitle = '角色分配';\n      this.$refs.userForm.resetFields();\n      var openId = v.openId; // 转换null为\"\"\n\n      for (var attr in v) {\n        if (v[attr] == null) {\n          v[attr] = '';\n        }\n      }\n\n      var str = JSON.stringify(v);\n      var data = JSON.parse(str);\n      this.miniUserForm = data;\n      this.ModalVisible = true;\n    },\n    add: function add(v) {\n      this.modalGrantTitle = '分配游戏';\n      this.$refs.userForm.resetFields();\n      var openId = v.openId; // 转换null为\"\"\n\n      for (var attr in v) {\n        if (v[attr] == null) {\n          v[attr] = '';\n        }\n      }\n\n      var str = JSON.stringify(v);\n      var data = JSON.parse(str);\n      this.miniUserForm = data;\n      this.ModalVisibleGrant = true;\n    },\n    submitMiniUser: function submitMiniUser() {\n      var _this3 = this;\n\n      this.$refs.userForm.validate(function (valid) {\n        if (valid) {\n          // 编辑\n          _this3.submitLoading = true;\n          editMiniUser({\n            openId: _this3.miniUserForm.openId,\n            roleId: _this3.userForm.roles\n          }).then(function (res) {\n            _this3.submitLoading = false;\n\n            if (res.success) {\n              _this3.$Message.success(\"操作成功\");\n\n              _this3.ModalVisible = false;\n            }\n          });\n        }\n      });\n    },\n    submitMiniGrant: function submitMiniGrant() {\n      var _this4 = this;\n\n      this.$refs.gameForm.validate(function (valid) {\n        if (valid) {\n          // 编辑\n          _this4.submitLoading = true;\n          editMiniUserGrant({\n            openId: _this4.miniUserForm.openId,\n            gameIds: _this4.gameForm.games\n          }).then(function (res) {\n            _this4.submitLoading = false;\n\n            if (res.success) {\n              _this4.$Message.success(\"操作成功\");\n\n              _this4.ModalVisibleGrant = false;\n            }\n          });\n        }\n      });\n    },\n    getRoleList: function getRoleList() {\n      var _this5 = this;\n\n      getAllMiniRoleList().then(function (res) {\n        if (res.success) {\n          _this5.roleList = JSON.parse(res.msg);\n        }\n      });\n    },\n    getGames: function getGames() {\n      var _this6 = this;\n\n      getAllGame().then(function (res) {\n        if (res.success) {\n          _this6.games = JSON.parse(res.msg);\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["miniUser.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div>\n        <!--        <Form ref=\"form\" :model=\"searchForm\" inline :label-width=\"70\" class=\"search-form\">-->\n        <!--            <Form-item label=\"用户名\" prop=\"name\"><Input type=\"text\" v-model=\"searchForm.name\" clearable-->\n\n        <!--                                                      placeholder=\"请输入用户名\" style=\"width: 200px\"/></Form-item>-->\n        <!--        </Form>-->\n        <!--        <Button @click=\"handleSearch\" type=\"primary\" icon=\"ios-search\">搜索</Button>-->\n        <Row>\n            <Table border :columns=\"columns\" :data=\"data\" sortable=\"custom\" ref=\"table\"></Table>\n        </Row>\n        <Row type=\"flex\" justify=\"end\" class=\"page\">\n            <Page\n                    :current=\"searchForm.pageNumber\"\n                    :total=\"total\"\n                    :page-size=\"searchForm.pageSize\"\n                    @on-change=\"changePage\"\n                    @on-page-size-change=\"changePageSize\"\n                    :page-size-opts=\"[10, 20, 50]\"\n                    size=\"small\"\n                    show-total\n                    show-elevator\n                    show-sizer\n            ></Page>\n        </Row>\n\n        <Modal\n                :title=\"modalTitle\"\n                v-model=\"ModalVisible\"\n                :mask-closable=\"false\"\n                :width=\"500\"\n                :styles=\"{top: '30px'}\"\n        >\n            <Form ref=\"userForm\" :model=\"userForm\" :label-width=\"70\">\n                <!--                <FormItem label=\"角色分配\" prop=\"roles\">-->\n                <!--                    <Select v-model=\"userForm.roles\" multiple>-->\n                <!--                        <Option v-for=\"item in roleList\" :value=\"item.id\" :key=\"item.id\" :label=\"item.name\">-->\n                <!--                            <span style=\"margin-right:10px;\">{{ item.name }}</span>-->\n                <!--                            &lt;!&ndash;                            <span style=\"color:#ccc;\">{{ item.description }}</span>&ndash;&gt;-->\n                <!--                        </Option>-->\n                <!--                    </Select>-->\n                <!--                </FormItem>-->\n                <FormItem label=\"角色分配\" prop=\"roles\">\n                    <Select v-model=\"userForm.roles\" style=\"width:200px\">\n                        <Option v-for=\"item in roleList\" :value=\"item.id\" :key=\"item.id\">{{ item.name }}</Option>\n                    </Select>\n                </FormItem>\n            </Form>\n            <div slot=\"footer\">\n                <Button type=\"text\" @click=\"ModalVisible = false\">取消</Button>\n                <Button type=\"primary\" :loading=\"submitLoading\" @click=\"submitMiniUser\">提交</Button>\n            </div>\n        </Modal>\n\n        <Modal\n                :title=\"modalGrantTitle\"\n                v-model=\"ModalVisibleGrant\"\n                :mask-closable=\"false\"\n                :width=\"500\"\n                :styles=\"{top: '30px'}\"\n        >\n            <Form ref=\"gameForm\" :model=\"gameForm\" :label-width=\"70\">\n                <FormItem label=\"游戏分配\" prop=\"games\">\n                    <Select v-model=\"gameForm.games\" multiple>\n                        <Option v-for=\"item in games\" :value=\"item.id\" :key=\"item.id\" :label=\"item.name\">\n                            <span style=\"margin-right:10px;\">{{ item.name }}</span>\n                        </Option>\n                    </Select>\n                </FormItem>\n            </Form>\n            <div slot=\"footer\">\n                <Button type=\"text\" @click=\"ModalVisibleGrant = false\">取消</Button>\n                <Button type=\"primary\" :loading=\"submitLoading\" @click=\"submitMiniGrant\">提交</Button>\n            </div>\n        </Modal>\n    </div>\n</template>\n\n<script>\n    import {queryAllUser, getAllMiniRoleList, editMiniUser, getAllGame, editMiniUserGrant} from '@/api/index';\n\n    export default {\n        name: \"miniUser\",\n        data() {\n            return {\n                columns: [\n                    {\n                        type: 'selection',\n                        width: 60,\n                        align: 'center',\n                        fixed: 'left'\n                    },\n                    {\n                        type: 'index',\n                        width: 60,\n                        align: 'center',\n                        fixed: 'left'\n                    },\n                    {\n                        title: 'openID',\n                        key: 'openId',\n                        width: 150\n                    },\n                    {\n                        title: '微信名',\n                        key: 'name',\n                        width: 150\n                    },\n                    // {\n                    //     title: '微信图片地址',\n                    //     key: 'avatarUrl',\n                    //     width: 300\n                    // },\n                    {\n                        title: \"头像\",\n                        key: \"avatarUrl\",\n                        width: 80,\n                        align: \"center\",\n                        render: (h, params) => {\n                            return h(\"Avatar\", {\n                                props: {\n                                    src: params.row.avatarUrl\n                                }\n                            });\n                        }\n                    },\n                    {\n                        title: '操作',\n                        key: 'action',\n                        width: 200,\n                        align: 'center',\n                        render: (h, params) => {\n                            let enableOrDisable = '';\n                            let editButton = h(\n                                'Button',\n                                {\n                                    props: {\n                                        type: 'primary',\n                                        size: 'small',\n                                        disabled: !this.$route.meta.permTypes.includes('edit')\n                                    },\n                                    style: {marginRight: '5px'},\n                                    on: {\n                                        click: () => {\n                                            this.edit(params.row);\n                                        }\n                                    }\n                                },\n                                '角色分配'\n                            );\n                            let grantButton = h(\n                                'Button',\n                                {\n                                    props: {\n                                        type: 'primary',\n                                        size: 'small',\n                                        disabled: !this.$route.meta.permTypes.includes('add')\n                                    },\n                                    style: {marginRight: '5px'},\n                                    on: {\n                                        click: () => {\n                                            this.add(params.row);\n                                        }\n                                    }\n                                },\n                                '授权游戏'\n                            );\n                            return h('div', [editButton, grantButton]);\n                        }\n                    }\n                ],\n                data: [],\n                searchForm: {\n                    name: '',\n                    pageNumber: 1,\n                    pageSize: 10\n                },\n                miniUserForm: [],\n                userForm: {\n                    roles: []\n                },\n                gameForm: {\n                    games: []\n                },\n                roleList: [],\n                modalType: 1,\n                modalTitle: '分配角色',\n                modalGrantTitle: '分配游戏',\n                ModalVisible: false,\n                ModalVisibleGrant: false,\n                total: 0,\n                submitLoading: false,\n                games: [],\n            }\n                ;\n        },\n        mounted() {\n            this.init();\n            this.getRoleList();\n            this.getGames();\n        },\n        methods: {\n            init() {\n                this.queryAll();\n            },\n            handleSearch() {\n                this.queryAll();\n            },\n            queryAll() {\n                queryAllUser(this.searchForm).then(res => {\n                    if (res.success) {\n                        this.data = res.msg.records;\n                        this.total = res.count;\n                    }\n                });\n            },\n            changePage(v) {\n                this.searchForm.pageNumber = v;\n                this.queryAll();\n                this.clearSelectAll();\n            },\n            changePageSize(v) {\n                this.searchForm.pageSize = v;\n                this.queryAll();\n            },\n            clearSelectAll() {\n                this.$refs.table.selectAll(false);\n            },\n            edit(v) {\n                this.modalType = 1;\n                this.modalTitle = '角色分配';\n                this.$refs.userForm.resetFields();\n                let openId = v.openId;\n\n                // 转换null为\"\"\n                for (let attr in v) {\n                    if (v[attr] == null) {\n                        v[attr] = '';\n                    }\n                }\n                let str = JSON.stringify(v);\n                let data = JSON.parse(str);\n                this.miniUserForm = data;\n                this.ModalVisible = true;\n            },\n            add(v) {\n                this.modalGrantTitle = '分配游戏';\n                this.$refs.userForm.resetFields();\n                let openId = v.openId;\n\n                // 转换null为\"\"\n                for (let attr in v) {\n                    if (v[attr] == null) {\n                        v[attr] = '';\n                    }\n                }\n                let str = JSON.stringify(v);\n                let data = JSON.parse(str);\n                this.miniUserForm = data;\n                this.ModalVisibleGrant = true;\n            },\n            submitMiniUser() {\n                this.$refs.userForm.validate(valid => {\n                    if (valid) {\n                        // 编辑\n                        this.submitLoading = true;\n                        editMiniUser({\n                            openId: this.miniUserForm.openId,\n                            roleId: this.userForm.roles,\n                        }).then(res => {\n                            this.submitLoading = false;\n                            if (res.success) {\n                                this.$Message.success(\"操作成功\");\n                                this.ModalVisible = false;\n                            }\n                        });\n                    }\n                });\n            },\n            submitMiniGrant() {\n                this.$refs.gameForm.validate(valid => {\n                    if (valid) {\n                        // 编辑\n                        this.submitLoading = true;\n                        editMiniUserGrant({\n                            openId: this.miniUserForm.openId,\n                            gameIds: this.gameForm.games,\n                        }).then(res => {\n                            this.submitLoading = false;\n                            if (res.success) {\n                                this.$Message.success(\"操作成功\");\n                                this.ModalVisibleGrant = false;\n                            }\n                        });\n                    }\n                });\n            },\n            getRoleList() {\n                getAllMiniRoleList().then(res => {\n                    if (res.success) {\n                        this.roleList = JSON.parse(res.msg);\n                    }\n                });\n            },\n            getGames() {\n                getAllGame().then(res => {\n                    if (res.success) {\n                        this.games = JSON.parse(res.msg);\n                    }\n                })\n            },\n        }\n    }\n</script>\n\n<style scoped>\n\n</style>\n"],"sourceRoot":"src/views/game/miniUser"}]}