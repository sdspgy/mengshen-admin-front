{"remainingRequest":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/game/upload-json/uploadJson.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/game/upload-json/uploadJson.vue","mtime":1574132205000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { uploadJson, loadRemoteConfigs, getListByEnable, getJsonByName as _getJsonByName } from \"@/api/index\";\nexport default {\n  name: \"uploadJson\",\n  data: function data() {\n    var _this = this;\n\n    return {\n      fileList: [],\n      errorList: [],\n      succesList: [],\n      serverList: [],\n      isShow: true,\n      loading: false,\n      fileName: '',\n      jsonStr: '',\n      jsonStrFormat: '',\n      dialogFormVisible: false,\n      columns: [{\n        type: \"index\",\n        width: 60,\n        align: \"center\"\n      }, {\n        title: \"服务器名称\",\n        key: \"name\",\n        align: \"center\",\n        width: 150\n      }, {\n        title: \"服务器地址\",\n        key: \"address\",\n        align: \"center\",\n        width: 150\n      }, {\n        title: \"端口\",\n        key: \"port\",\n        align: \"center\",\n        width: 100\n      }, {\n        title: \"请求url\",\n        key: \"requestUrl\",\n        align: \"center\",\n        width: 200\n      }, {\n        title: \"加载状态\",\n        key: \"success\",\n        align: \"center\",\n        width: 100,\n        render: function render(h, params) {\n          if (_this.isShow) {\n            return h(\"div\", params.row.success);\n          } else {\n            return '';\n          }\n        }\n      }, {\n        title: \"加载远程配置返回信息\",\n        key: \"msg\",\n        align: \"center\",\n        width: 300\n      }]\n    };\n  },\n  methods: {\n    init: function init() {\n      this.getServerList();\n    },\n    handleUpload: function handleUpload(file) {\n      this.fileList.push(file);\n      return false;\n    },\n    upload: function upload() {\n      var _this2 = this;\n\n      console.log('>>>>', this.fileList);\n\n      if (this.fileList.length == 0) {\n        this.$Message.error('未选择文件！');\n        return;\n      }\n\n      var formData = new FormData();\n\n      for (var i = 0; i < this.fileList.length; i++) {\n        formData.append(\"file\", this.fileList[i]);\n      }\n\n      uploadJson(formData).then(function (res) {\n        if (res.status === 200) {\n          _this2.fileList = [];\n\n          _this2.$Message.success('上传成功');\n\n          _this2.succesList = res.data.succ;\n          _this2.errorList = res.data.error;\n        } else {\n          _this2.$Message.error(res.data);\n        }\n      });\n    },\n    deleteFile: function deleteFile(index) {\n      this.fileList.splice(index, 1);\n    },\n    getServerList: function getServerList() {\n      var _this3 = this;\n\n      if (!this.$route.meta.permTypes.includes('other')) {\n        return;\n      }\n\n      getListByEnable().then(function (res) {\n        if (res.success) {\n          _this3.isShow = false;\n          _this3.serverList = res.result;\n        }\n      });\n    },\n    loadRemoteConfig: function loadRemoteConfig() {\n      var _this4 = this;\n\n      this.loading = true;\n      loadRemoteConfigs().then(function (res) {\n        _this4.loading = false;\n        _this4.serverList = res.result;\n      });\n    },\n    openDialog: function openDialog() {\n      this.getJsonByName();\n    },\n    hideDialog: function hideDialog() {\n      this.dialogFormVisible = false;\n    },\n    getJsonByName: function getJsonByName() {\n      var _this5 = this;\n\n      this.jsonStr = '';\n\n      _getJsonByName({\n        fileName: this.fileName\n      }).then(function (res) {\n        if (res.status === 200) {\n          if (res.data.error) {\n            _this5.hideDialog();\n\n            _this5.$Message.error(res.data.error);\n          } else {\n            _this5.dialogFormVisible = true;\n            _this5.jsonStr = res.data.jsonStr;\n          }\n        }\n      });\n    },\n    clickCopyPre: function clickCopyPre() {\n      var div = document.getElementById('copyPre');\n\n      if (document.body.createTextRange) {\n        var range = document.body.createTextRange();\n        range.moveToElementText(div);\n        range.select();\n      } else if (window.getSelection) {\n        var selection = window.getSelection();\n        var range = document.createRange();\n        range.selectNodeContents(div);\n        selection.removeAllRanges();\n        selection.addRange(range);\n      } else {\n        console.warn(\"none\");\n      }\n\n      document.execCommand(\"Copy\"); // 执行浏览器复制命令\n\n      this.$Message.success(\"\\u590D\\u5236\\u6210\\u529F\");\n    }\n  },\n  mounted: function mounted() {\n    this.init();\n  }\n};",{"version":3,"sources":["uploadJson.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <Divider>JSON上传</Divider>\n    <Upload\n      multiple\n      ref=\"upload\"\n      type=\"drag\"\n      accept=\".json, .JSON\"\n      :max-size=\"5000\"\n      :before-upload=\"handleUpload\"\n      action=\"#\"\n    >\n      <div style=\"padding: 20px 0\">\n        <Icon type=\"ios-cloud-upload\" size=\"52\" style=\"color: #3399ff\"></Icon>\n        <p>点击或者拖拽到此次上传文件</p>\n      </div>\n    </Upload>\n    <div>\n      <ul class=\"file-list\" v-for=\"(file,index) in fileList\" :key=\"index\">\n        <li>文件名: <span style=\"font-size:15px;\">{{ file.name }} </span> <Button @click=\"deleteFile(index)\">删除</Button></li>\n      </ul>\n    </div>\n    <Button type=\"primary\"  @click=\"upload\" v-if=\"this.$route.meta.permTypes.includes('upload')\">上传</Button>\n    <Button type=\"primary\"  @click=\"upload\" v-else=\"!this.$route.meta.permTypes.includes('upload')\" disabled>上传</Button>\n\n    <h2 v-show=\"succesList.length>0\">成功信息</h2>\n    <ul class=\"file-list\" v-for=\"(item,index) in succesList\" :key=\"index\">\n      <li><span style=\"font-size:15px;\">{{ item }}</span></li>\n    </ul>\n    <h2 v-show=\"errorList.length>0\">错误信息</h2>\n    <ul class=\"file-list\" v-for=\"(item,index) in errorList\" :key=\"index\">\n      <li><span style=\"font-size:15px;\">{{ item }}</span></li>\n    </ul>\n\n    <Divider>查看服务器JSON</Divider>\n    <Input type=\"text\" v-model=\"fileName\" clearable placeholder=\"请输入文件名 xxx.json\" style=\"width: 200px\"/>\n    <Button @click=\"openDialog\">查看服务器JSON</Button>\n\n    <Modal title=服务器JSON v-model=\"dialogFormVisible\" :mask-closable=\"false\" width=\"1000\">\n      <Button @click=\"clickCopyPre()\">点击复制</Button><br>\n      <pre id=\"copyPre\">\n        {{jsonStr}}\n      </pre>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <Button @click=\"hideDialog()\">取 消</Button>\n      </div>\n    </Modal>\n\n    <Divider>服务器列表</Divider>\n\n    <Row  v-show=\"this.$route.meta.permTypes.includes('other')\">\n      <Table border :columns=\"columns\" :data=\"serverList\" ref=\"table\"></Table>\n      <Button @click=\"loadRemoteConfig()\" type=\"info\" :loading=\"loading\">加载远程配置</Button>\n    </Row>\n  </div>\n</template>\n\n<script>\n    import {uploadJson,loadRemoteConfigs,getListByEnable,getJsonByName} from \"@/api/index\";\n\n    export default {\n        name: \"uploadJson\",\n        data () {\n            return {\n                fileList: [],\n                errorList: [],\n                succesList: [],\n                serverList: [],\n                isShow: true,\n                loading: false,\n                fileName:'',\n                jsonStr:'',\n                jsonStrFormat: '',\n                dialogFormVisible: false,\n                columns: [\n                    {type: \"index\", width: 60, align: \"center\"},\n                    {title: \"服务器名称\", key: \"name\", align: \"center\", width: 150},\n                    {title: \"服务器地址\", key: \"address\", align: \"center\", width: 150,},\n                    {title: \"端口\", key: \"port\", align: \"center\", width: 100,},\n                    {title: \"请求url\", key: \"requestUrl\", align: \"center\", width: 200,},\n                    {title: \"加载状态\", key: \"success\", align: \"center\", width: 100,\n                        render: (h, params) => {\n                            if (this.isShow) {\n                                return h(\"div\", params.row.success);\n                            } else  {\n                                return '';\n                            }\n                        }},\n                    {title: \"加载远程配置返回信息\", key: \"msg\", align: \"center\", width: 300,},\n                ],\n            }\n        },\n        methods: {\n            init() {\n                this.getServerList();\n            },\n            handleUpload (file) {\n                this.fileList.push(file);\n                return false;\n            },\n            upload () {\n                console.log('>>>>', this.fileList)\n                if (this.fileList.length == 0) {\n                    this.$Message.error('未选择文件！');\n                    return;\n                }\n                let formData = new FormData();\n                for(var i=0; i< this.fileList.length; i++){\n                    formData.append(\"file\",this.fileList[i]);\n                }\n                uploadJson(formData).then(res=>{\n                    if (res.status === 200) {\n                        this.fileList = [];\n                        this.$Message.success('上传成功');\n                        this.succesList = res.data.succ;\n                        this.errorList = res.data.error;\n                    }else {\n                        this.$Message.error(res.data);\n                    }\n                })\n            },\n            deleteFile(index) {\n                this.fileList.splice(index,1);\n            },\n            getServerList() {\n                if (!this.$route.meta.permTypes.includes('other')) {\n                    return\n                }\n                getListByEnable().then(res =>{\n                    if (res.success){\n                        this.isShow = false;\n                        this.serverList = res.result;\n                    }\n                })\n            },\n            loadRemoteConfig() {\n                this.loading = true;\n                loadRemoteConfigs().then(res=>{\n                    this.loading = false;\n                    this.serverList = res.result;\n                })\n            },\n            openDialog() {\n                this.getJsonByName();\n            },\n            hideDialog() {\n                this.dialogFormVisible = false;\n            },\n            getJsonByName(){\n                this.jsonStr = '';\n                getJsonByName({fileName: this.fileName}).then(res=>{\n                    if (res.status === 200){\n                        if (res.data.error){\n                            this.hideDialog();\n                            this.$Message.error(res.data.error);\n                        }else {\n                            this.dialogFormVisible = true;\n                            this.jsonStr = res.data.jsonStr;\n                        }\n                    }\n                })\n            },\n            clickCopyPre(){\n                var div = document.getElementById('copyPre');\n                if (document.body.createTextRange) {\n                    var range = document.body.createTextRange();\n                    range.moveToElementText(div);\n                    range.select();\n                } else if (window.getSelection) {\n                    var selection = window.getSelection();\n                    var range = document.createRange();\n                    range.selectNodeContents(div);\n                    selection.removeAllRanges();\n                    selection.addRange(range);\n                } else {\n                    console.warn(\"none\");\n                }\n                document.execCommand(\"Copy\"); // 执行浏览器复制命令\n\n                this.$Message.success(`复制成功`);\n            },\n        },\n        mounted() {\n            this.init();\n        }\n\n    }\n</script>\n\n<style scoped>\n\n  #loadResult{\n    max-width: 90%;\n    word-wrap: break-word;\n    word-break: break-all;\n    overflow: hidden;\n  }\n  pre {outline: 1px solid #ccc; padding: 5px; margin: 5px; }\n\n</style>\n"],"sourceRoot":"src/views/game/upload-json"}]}