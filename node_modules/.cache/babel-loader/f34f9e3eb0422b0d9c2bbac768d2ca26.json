{"remainingRequest":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/sys/server-manage/serverManage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/sys/server-manage/serverManage.vue","mtime":1574132205000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getServerByPage as _getServerByPage, addServer as _addServer, updateServer, disableServer, enableServer, setDefaultServer, getDefaultServer, getServerListByParentId as _getServerListByParentId } from \"@/api/index\";\nexport default {\n  name: \"serverManage\",\n  data: function data() {\n    var _this = this;\n\n    return {\n      currServer: \"\",\n      loading: true,\n      selectList: [],\n      selectCount: 0,\n      dialogFormVisible: false,\n      viewDialogFormVisible: false,\n      dialogFormTitle: '',\n      isEdit: false,\n      columns: [{\n        type: \"selection\",\n        width: 60,\n        align: \"center\"\n      }, {\n        type: \"index\",\n        width: 60,\n        align: \"center\"\n      }, {\n        title: \"服务器名称\",\n        key: \"name\",\n        align: \"center\",\n        width: 150,\n        sortable: true\n      }, {\n        title: \"服务器地址\",\n        key: \"address\",\n        align: \"center\",\n        width: 150,\n        sortable: true\n      }, {\n        title: \"端口\",\n        key: \"port\",\n        align: \"center\",\n        width: 100\n      }, {\n        title: \"状态\",\n        key: \"state\",\n        align: \"center\",\n        width: 100,\n        sortable: true,\n        render: function render(h, params) {\n          if (params.row.status == 0) {\n            return h(\"div\", [h(\"Tag\", {\n              props: {\n                color: \"blue\"\n              }\n            }, \"正常\")]);\n          } else if (params.row.status == -1) {\n            return h(\"div\", [h(\"Tag\", {\n              props: {\n                color: \"red\"\n              }\n            }, \"弃用\")]);\n          }\n        }\n      }, {\n        title: \"创建时间\",\n        key: \"createTime\",\n        align: \"center\",\n        width: 180,\n        sortable: true,\n        sortType: \"desc\"\n      }, {\n        title: \"更新时间\",\n        key: \"updateTime\",\n        align: \"center\",\n        width: 180,\n        sortable: true\n      }, {\n        title: \"操作\",\n        key: \"action\",\n        align: \"center\",\n        width: 300,\n        render: function render(h, params) {\n          var enableOrDisable = \"\";\n          var showButton = \"\";\n          var editButton = h(\"Button\", {\n            props: {\n              type: \"primary\",\n              size: \"small\",\n              disabled: !_this.$route.meta.permTypes.includes('edit')\n            },\n            style: {\n              marginRight: \"5px\"\n            },\n            on: {\n              click: function click() {\n                _this.openEditDialog(params.row);\n              }\n            }\n          }, \"编辑\");\n\n          if (params.row.status == 0) {\n            enableOrDisable = h(\"Button\", {\n              props: {\n                size: \"small\",\n                disabled: !_this.$route.meta.permTypes.includes('disable')\n              },\n              style: {\n                marginRight: \"5px\"\n              },\n              on: {\n                click: function click() {\n                  _this.disable(params.row);\n                }\n              }\n            }, \"禁用\");\n          } else {\n            enableOrDisable = h(\"Button\", {\n              props: {\n                type: \"success\",\n                size: \"small\",\n                disabled: !_this.$route.meta.permTypes.includes('enable')\n              },\n              style: {\n                marginRight: \"5px\"\n              },\n              on: {\n                click: function click() {\n                  _this.enable(params.row);\n                }\n              }\n            }, \"启用\");\n          }\n\n          ;\n          var setDefaultButton = \"\";\n\n          if (params.row.parentId == \"0\") {\n            showButton = h(\"Button\", {\n              props: {\n                type: \"info\",\n                size: \"small\"\n              },\n              style: {\n                marginRight: \"5px\"\n              },\n              on: {\n                click: function click() {\n                  _this.openShowDialog(params.row);\n                }\n              }\n            }, \"查看\");\n            setDefaultButton = h(\"Button\", {\n              props: {\n                type: \"info\",\n                size: \"small\",\n                disabled: _this.currServer.id == params.row.id\n              },\n              style: {\n                marginRight: \"5px\"\n              },\n              on: {\n                click: function click() {\n                  _this.setDefault(params.row);\n                }\n              }\n            }, \"设为操作服\");\n          }\n\n          return h(\"div\", [showButton, editButton, enableOrDisable, setDefaultButton]);\n        }\n      }],\n      data: [],\n      childrenData: [],\n      serverForm: {\n        name: \"\",\n        address: \"\",\n        port: \"\",\n        parentId: \"0\"\n      },\n      viewServer: {},\n      sortColumn: \"createTime\",\n      sortType: \"desc\",\n      pageNumber: 1,\n      pageSize: 10,\n      total: 0\n    };\n  },\n  methods: {\n    init: function init() {\n      this.getServerByPage();\n      this.getDefault();\n    },\n    getServerByPage: function getServerByPage() {\n      var _this2 = this;\n\n      var params = {\n        pageNumber: this.pageNumber,\n        pageSize: this.pageSize,\n        sort: this.sortColumn,\n        order: this.sort\n      };\n      this.loading = true;\n\n      _getServerByPage(params).then(function (res) {\n        _this2.loading = false;\n\n        if (res.success) {\n          _this2.data = res.result.records;\n          _this2.total = res.result.total;\n\n          if (res.result.content || res.result.totalElements) {\n            _this2.data = res.result.content;\n            _this2.total = res.result.totalElements;\n          }\n        }\n      });\n    },\n    refresh: function refresh() {\n      if (this.viewDialogFormVisible) {\n        this.getServerListByParentId();\n      } else {\n        this.getServerByPage();\n      }\n    },\n    addServer: function addServer() {\n      var _this3 = this;\n\n      if (!this.checkFormData()) {\n        return;\n      }\n\n      _addServer(this.serverForm).then(function (res) {\n        if (res.success) {\n          _this3.hideAddDialog();\n\n          _this3.refresh();\n        }\n      });\n    },\n    editServer: function editServer() {\n      var _this4 = this;\n\n      if (!this.checkFormData()) {\n        return;\n      }\n\n      updateServer(this.serverForm).then(function (res) {\n        if (res.success) {\n          _this4.hideAddDialog();\n\n          _this4.refresh();\n        }\n      });\n    },\n    checkFormData: function checkFormData() {\n      if (!this.serverForm.name) {\n        this.$Message.error(\"请输入服务器名称\");\n        return false;\n      }\n\n      if (!this.serverForm.address) {\n        this.$Message.error(\"请输入服务器地址\");\n        return false;\n      }\n\n      if (!this.serverForm.port) {\n        this.serverForm.port = 80;\n      }\n\n      return true;\n    },\n    clearSelectAll: function clearSelectAll() {\n      this.$refs.table.selectAll(false);\n    },\n    changeSelect: function changeSelect(e) {\n      this.selectList = e;\n      this.selectCount = e.length;\n    },\n    changePage: function changePage(v) {\n      this.pageNumber = v;\n      this.getServerByPage();\n      this.clearSelectAll();\n    },\n    changePageSize: function changePageSize(v) {\n      this.pageSize = v;\n      this.getServerByPage();\n    },\n    changeSort: function changeSort(e) {\n      this.sortColumn = e.key;\n      this.sortType = e.order;\n\n      if (e.order == \"normal\") {\n        this.sortType = \"\";\n      }\n\n      this.getServerByPage();\n    },\n    openAddDialog: function openAddDialog() {\n      this.dialogFormTitle = '添加服务器';\n      this.serverForm = {};\n      this.serverForm.parentId = \"0\";\n      this.isEdit = false;\n      this.dialogFormVisible = true;\n    },\n    hideAddDialog: function hideAddDialog() {\n      this.dialogFormVisible = false;\n      this.refresh();\n    },\n    openAddDialogWithChildren: function openAddDialogWithChildren() {\n      this.openAddDialog();\n      this.dialogFormTitle = '添加子服务器';\n      this.serverForm.parentId = this.viewServer.id;\n    },\n    hideViewDialog: function hideViewDialog() {\n      this.viewDialogFormVisible = false;\n      this.getServerByPage();\n    },\n    openShowDialog: function openShowDialog(scopeRow) {\n      this.viewServer = scopeRow;\n      this.getServerListByParentId();\n      this.viewDialogFormVisible = true;\n    },\n    getServerListByParentId: function getServerListByParentId() {\n      var _this5 = this;\n\n      _getServerListByParentId({\n        parentId: this.viewServer.id\n      }).then(function (res) {\n        if (res.success) {\n          _this5.childrenData = res.result;\n        }\n      });\n    },\n    openEditDialog: function openEditDialog(scopeRow) {\n      this.dialogFormTitle = '修改服务器';\n      this.isEdit = true;\n      this.serverForm = scopeRow;\n      this.dialogFormVisible = true;\n    },\n    enable: function enable(v) {\n      var _this6 = this;\n\n      this.$Modal.confirm({\n        title: \"确认启用\",\n        content: \"您确认要启用服务器 \" + v.name + \" ?\",\n        loading: true,\n        onOk: function onOk() {\n          enableServer({\n            id: v.id\n          }).then(function (res) {\n            _this6.$Modal.remove();\n\n            if (res.success) {\n              _this6.$Message.success(\"操作成功\");\n\n              _this6.refresh();\n            }\n          });\n        }\n      });\n    },\n    disable: function disable(v) {\n      var _this7 = this;\n\n      this.$Modal.confirm({\n        title: \"确认禁用\",\n        content: \"您确认要禁用服务器 \" + v.name + \" ?\",\n        loading: true,\n        onOk: function onOk() {\n          disableServer({\n            id: v.id\n          }).then(function (res) {\n            _this7.$Modal.remove();\n\n            if (res.success) {\n              _this7.$Message.success(\"操作成功\");\n\n              _this7.refresh();\n            }\n          });\n        }\n      });\n    },\n    setDefault: function setDefault(v) {\n      var _this8 = this;\n\n      this.$Modal.confirm({\n        title: \"确认设置\",\n        content: \"您确认要 \" + v.name + \" 为默认操作服务器?\",\n        loading: true,\n        onOk: function onOk() {\n          setDefaultServer({\n            id: v.id\n          }).then(function (res) {\n            _this8.$Modal.remove();\n\n            if (res.success) {\n              _this8.$Message.success(res.message);\n            } else {\n              _this8.$Message.error(res.message);\n            }\n\n            _this8.getDefault();\n          });\n        }\n      });\n    },\n    getDefault: function getDefault() {\n      var _this9 = this;\n\n      this.currServer = \"\";\n      getDefaultServer().then(function (res) {\n        if (res.success) {\n          _this9.currServer = res.result;\n        }\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.init();\n  }\n};",{"version":3,"sources":["serverManage.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"search\">\n    <Row>\n      <Col>\n        <Card>\n          <Row>\n            <div v-if=\"currServer\">\n              <h2>当前操作主服务器</h2>\n              <h4>服务器名称:{{currServer.name}}</h4>\n              <h4>服务器地址:{{currServer.address}}</h4>\n              <h4>服务器端口:{{currServer.port}}</h4>\n            </div>\n            <div v-else>\n              <h2>还未选择操作主服务器</h2>\n            </div>\n            <hr><br>\n          </Row>\n          <Row>\n            <Modal :title=dialogFormTitle v-model=\"dialogFormVisible\" :mask-closable=\"false\" width=\"50%\">\n              <Form :model=\"serverForm\" :label-width=\"120\">\n\n                <FormItem label=\"服务器名称\">\n                  <Input v-model=\"serverForm.name\" autocomplete=\"off\" placeholder=\"请输入服务器名称\"/>\n                </FormItem>\n\n                <FormItem label=\"服务器地址\" >\n                  <Input v-model=\"serverForm.address\" autocomplete=\"off\" placeholder=\"请输入服务器地址ip或域名  例10.10.10.10 或 www.huai.com \"/>\n                </FormItem>\n\n                <FormItem label=\"端口\" >\n                  <Input v-model=\"serverForm.port\" autocomplete=\"off\" placeholder=\"请输入端口号，default_port:80\"/>\n                </FormItem>\n              </Form>\n              <div slot=\"footer\">\n                <Button @click=\"hideAddDialog()\">取 消</Button>\n                <Button type=\"primary\" @click=\"addServer()\" v-show=\"!isEdit\">添加</Button>\n                <Button type=\"primary\" @click=\"editServer()\" v-show=\"isEdit\">修改</Button>\n              </div>\n            </Modal>\n          </Row>\n          <Row>\n            <Modal title=\"查看服务器组\" v-model=\"viewDialogFormVisible\" :mask-closable=\"false\" width=\"1000px\">\n              <h2>当前服务器</h2>\n              <h4>服务器名称:{{viewServer.name}}</h4>\n              <h4>服务器地址:{{viewServer.address}}</h4>\n              <h4>服务器端口:{{viewServer.port}}</h4>\n              <h2>当前子服务器列表</h2>\n              <Button @click=\"openAddDialogWithChildren\" type=\"primary\" icon=\"md-add\">添加子服务器</Button>\n              <Table border :columns=\"columns\" :data=\"childrenData\" ref=\"table\" sortable=\"custom\"></Table>\n              <div slot=\"footer\">\n                <Button @click=\"hideViewDialog()\">取 消</Button>\n              </div>\n            </Modal>\n          </Row>\n          <Row class=\"operation\">\n            <Button @click=\"openAddDialog\" type=\"primary\" icon=\"md-add\" v-show=\"this.$route.meta.permTypes.includes('add')\">添加主服务器</Button>\n            <Button @click=\"getServerByPage\" v-show=\"this.$route.meta.permTypes.includes('view')\">刷新</Button>\n          </Row>\n          <Row>\n            <Alert show-icon>\n              已选择\n              <span class=\"select-count\">{{selectCount}}</span> 项\n              <a class=\"select-clear\" @click=\"clearSelectAll\">清空</a>\n            </Alert>\n          </Row>\n          <Row>\n            <h2>主服务器列表</h2>\n            <Table\n                    :loading=\"loading\"\n                    border\n                    :columns=\"columns\"\n                    :data=\"data\"\n                    ref=\"table\"\n                    sortable=\"custom\"\n                    @on-sort-change=\"changeSort\"\n                    @on-selection-change=\"changeSelect\"\n            ></Table>\n          </Row>\n          <Row type=\"flex\" justify=\"end\" class=\"page\">\n            <Page\n                    :current=\"pageNumber\"\n                    :total=\"total\"\n                    :page-size=\"pageSize\"\n                    @on-change=\"changePage\"\n                    @on-page-size-change=\"changePageSize\"\n                    :page-size-opts=\"[10,20,50]\"\n                    size=\"small\"\n                    show-total\n                    show-elevator\n                    show-sizer\n            ></Page>\n          </Row>\n        </Card>\n      </Col>\n    </Row>\n\n  </div>\n</template>\n\n<script>\n    import {getServerByPage,addServer,updateServer,disableServer,enableServer,setDefaultServer,getDefaultServer,getServerListByParentId} from \"@/api/index\";\n    export default {\n        name: \"serverManage\",\n        data(){\n            return{\n                currServer: \"\",\n                loading: true,\n                selectList: [],\n                selectCount: 0,\n                dialogFormVisible: false,\n                viewDialogFormVisible: false,\n                dialogFormTitle: '',\n                isEdit: false,\n                columns: [\n                    {\n                        type: \"selection\",\n                        width: 60,\n                        align: \"center\"\n                    },\n                    {\n                        type: \"index\",\n                        width: 60,\n                        align: \"center\"\n                    },\n                    {\n                        title: \"服务器名称\",\n                        key: \"name\",\n                        align: \"center\",\n                        width: 150,\n                        sortable: true\n                    },\n                    {\n                        title: \"服务器地址\",\n                        key: \"address\",\n                        align: \"center\",\n                        width: 150,\n                        sortable: true\n                    },\n                    {\n                        title: \"端口\",\n                        key: \"port\",\n                        align: \"center\",\n                        width: 100,\n                    },\n                    {\n                        title: \"状态\",\n                        key: \"state\",\n                        align: \"center\",\n                        width: 100,\n                        sortable: true,\n                        render: (h, params) => {\n                            if (params.row.status == 0) {\n                                return h(\"div\", [h(\"Tag\", {props: {color: \"blue\"}}, \"正常\")]);\n                            } else if (params.row.status == -1) {\n                                return h(\"div\", [h(\"Tag\", {props: {color: \"red\"}}, \"弃用\")]);\n                            }\n                        }\n                    },\n                    {\n                        title: \"创建时间\",\n                        key: \"createTime\",\n                        align: \"center\",\n                        width: 180,\n                        sortable: true,\n                        sortType: \"desc\"\n                    },\n                    {\n                        title: \"更新时间\",\n                        key: \"updateTime\",\n                        align: \"center\",\n                        width: 180,\n                        sortable: true\n                    },\n                    {\n                        title: \"操作\",\n                        key: \"action\",\n                        align: \"center\",\n                        width: 300,\n                        render: (h, params) => {\n                            let enableOrDisable = \"\";\n                            let showButton = \"\";\n                            let editButton = h(\"Button\", {props: {type: \"primary\", size: \"small\",disabled:!this.$route.meta.permTypes.includes('edit')}, style: {marginRight: \"5px\"}, on: {click: () => {this.openEditDialog(params.row);}}}, \"编辑\");\n                            if (params.row.status == 0) {\n                                enableOrDisable = h(\"Button\", {props: {size: \"small\",disabled:!this.$route.meta.permTypes.includes('disable')}, style: {marginRight: \"5px\"}, on: {click: () => {this.disable(params.row);}}}, \"禁用\");\n                            } else {\n                                enableOrDisable = h(\"Button\", {props: {type: \"success\", size: \"small\",disabled:!this.$route.meta.permTypes.includes('enable')}, style: {marginRight: \"5px\"}, on: {click: () => {this.enable(params.row);}}}, \"启用\");\n                            };\n                            let setDefaultButton = \"\";\n                            if (params.row.parentId == \"0\") {\n                                showButton = h(\"Button\", {props: {type: \"info\", size: \"small\"}, style: {marginRight: \"5px\"}, on: {click: () => {this.openShowDialog(params.row);}}}, \"查看\");\n                                setDefaultButton = h(\"Button\", {props: {type: \"info\", size: \"small\",disabled:this.currServer.id == params.row.id}, style: {marginRight: \"5px\"}, on: {click: () => {this.setDefault(params.row);}}}, \"设为操作服\");\n                            }\n                            return h(\"div\", [showButton,editButton, enableOrDisable, setDefaultButton]);\n                        }\n                    }\n                ],\n                data: [],\n                childrenData: [],\n                serverForm: {\n                    name: \"\",\n                    address: \"\",\n                    port:\"\",\n                    parentId: \"0\"\n                },\n                viewServer: {},\n                sortColumn: \"createTime\",\n                sortType: \"desc\",\n                pageNumber: 1,\n                pageSize: 10,\n                total: 0,\n            }\n        },\n        methods:{\n            init(){\n                this.getServerByPage();\n                this.getDefault();\n            },\n            getServerByPage(){\n                let params = {\n                    pageNumber: this.pageNumber,\n                    pageSize: this.pageSize,\n                    sort: this.sortColumn,\n                    order: this.sort,\n                };\n                this.loading = true;\n              getServerByPage(params).then(res=>{\n                  this.loading = false;\n                  if (res.success) {\n                      this.data = res.result.records;\n                      this.total = res.result.total\n                      if (res.result.content || res.result.totalElements){\n                          this.data =  res.result.content;\n                          this.total = res.result.totalElements;\n                      }\n                  }\n              })\n            },\n            refresh(){\n                if (this.viewDialogFormVisible){\n                    this.getServerListByParentId()\n                } else {\n                    this.getServerByPage();\n                }\n            },\n            addServer(){\n                if (!this.checkFormData()) {\n                    return;\n                }\n                addServer(this.serverForm).then(res=>{\n                    if (res.success) {\n                        this.hideAddDialog();\n                        this.refresh();\n                    }\n                })\n            },\n            editServer(){\n                if (!this.checkFormData()) {\n                    return;\n                }\n                updateServer(this.serverForm).then(res=>{\n                    if (res.success) {\n                        this.hideAddDialog();\n                        this.refresh();\n                    }\n                })\n            },\n            checkFormData(){\n                if (!this.serverForm.name){\n                    this.$Message.error(\"请输入服务器名称\");\n                    return false;\n                }\n                if (!this.serverForm.address){\n                    this.$Message.error(\"请输入服务器地址\");\n                    return false;\n                }\n                if (!this.serverForm.port){\n                    this.serverForm.port = 80;\n                }\n                return true;\n            },\n            clearSelectAll() {\n                this.$refs.table.selectAll(false);\n            },\n            changeSelect(e) {\n                this.selectList = e;\n                this.selectCount = e.length;\n            },\n            changePage(v) {\n                this.pageNumber = v;\n                this.getServerByPage();\n                this.clearSelectAll();\n            },\n            changePageSize(v) {\n                this.pageSize = v;\n                this.getServerByPage();\n            },\n            changeSort(e) {\n                this.sortColumn = e.key;\n                this.sortType = e.order;\n                if (e.order == \"normal\") {\n                    this.sortType = \"\";\n                }\n                this.getServerByPage();\n            },\n            openAddDialog() {\n                this.dialogFormTitle = '添加服务器';\n                this.serverForm = {};\n                this.serverForm.parentId = \"0\";\n                this.isEdit = false;\n                this.dialogFormVisible = true;\n            },\n            hideAddDialog() {\n                this.dialogFormVisible = false;\n                this.refresh();\n            },\n            openAddDialogWithChildren() {\n                this.openAddDialog();\n                this.dialogFormTitle = '添加子服务器';\n                this.serverForm.parentId = this.viewServer.id;\n            },\n            hideViewDialog() {\n                this.viewDialogFormVisible = false;\n                this.getServerByPage();\n            },\n            openShowDialog(scopeRow){\n                this.viewServer = scopeRow;\n                this.getServerListByParentId();\n                this.viewDialogFormVisible = true;\n            },\n            getServerListByParentId(){\n                getServerListByParentId({parentId:this.viewServer.id}).then(res=>{\n                    if (res.success) {\n                        this.childrenData = res.result;\n                    }\n                })\n            },\n            openEditDialog(scopeRow) {\n                this.dialogFormTitle = '修改服务器';\n                this.isEdit = true;\n                this.serverForm = scopeRow;\n                this.dialogFormVisible = true;\n            },\n            enable(v) {\n                this.$Modal.confirm({\n                    title: \"确认启用\",\n                    content: \"您确认要启用服务器 \" + v.name + \" ?\",\n                    loading: true,\n                    onOk: () => {\n                        enableServer({id:v.id}).then(res => {\n                            this.$Modal.remove();\n                            if (res.success) {\n                                this.$Message.success(\"操作成功\");\n                                this.refresh();\n                            }\n                        });\n                    }\n                });\n            },\n            disable(v) {\n                this.$Modal.confirm({\n                    title: \"确认禁用\",\n                    content: \"您确认要禁用服务器 \" + v.name + \" ?\",\n                    loading: true,\n                    onOk: () => {\n                        disableServer({id:v.id}).then(res => {\n                            this.$Modal.remove();\n                            if (res.success) {\n                                this.$Message.success(\"操作成功\");\n                                this.refresh();\n                            }\n                        });\n                    }\n                });\n            },\n            setDefault(v) {\n                this.$Modal.confirm({\n                    title: \"确认设置\",\n                    content: \"您确认要 \" + v.name + \" 为默认操作服务器?\",\n                    loading: true,\n                    onOk: () => {\n                        setDefaultServer({id:v.id}).then(res => {\n                            this.$Modal.remove();\n                            if (res.success) {\n                                this.$Message.success(res.message);\n                            }else {\n                                this.$Message.error(res.message);\n                            }\n                            this.getDefault();\n                        });\n                    }\n                });\n            },\n            getDefault(){\n                this.currServer = \"\";\n                getDefaultServer().then(res => {\n                    if (res.success) {\n                        this.currServer = res.result;\n                    }\n                })\n            }\n        },\n        mounted() {\n            this.init();\n        }\n    }\n</script>\n\n<style scoped>\n\n</style>\n"],"sourceRoot":"src/views/sys/server-manage"}]}