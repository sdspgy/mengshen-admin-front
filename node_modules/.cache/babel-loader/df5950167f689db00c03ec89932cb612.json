{"remainingRequest":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/thread-loader/dist/cjs.js!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/sys/server-manage/serverManage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/sys/server-manage/serverManage.vue","mtime":1574132205000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getServerByPage as _getServerByPage, addServer as _addServer, updateServer, disableServer, enableServer, setDefaultServer, getDefaultServer, getServerListByParentId as _getServerListByParentId } from \"@/api/index\";\nexport default {\n  name: \"serverManage\",\n  data: function data() {\n    var _this = this;\n\n    return {\n      currServer: \"\",\n      loading: true,\n      selectList: [],\n      selectCount: 0,\n      dialogFormVisible: false,\n      viewDialogFormVisible: false,\n      dialogFormTitle: '',\n      isEdit: false,\n      columns: [{\n        type: \"selection\",\n        width: 60,\n        align: \"center\"\n      }, {\n        type: \"index\",\n        width: 60,\n        align: \"center\"\n      }, {\n        title: \"服务器名称\",\n        key: \"name\",\n        align: \"center\",\n        width: 150,\n        sortable: true\n      }, {\n        title: \"服务器地址\",\n        key: \"address\",\n        align: \"center\",\n        width: 150,\n        sortable: true\n      }, {\n        title: \"端口\",\n        key: \"port\",\n        align: \"center\",\n        width: 100\n      }, {\n        title: \"状态\",\n        key: \"state\",\n        align: \"center\",\n        width: 100,\n        sortable: true,\n        render: function render(h, params) {\n          if (params.row.status == 0) {\n            return h(\"div\", [h(\"Tag\", {\n              props: {\n                color: \"blue\"\n              }\n            }, \"正常\")]);\n          } else if (params.row.status == -1) {\n            return h(\"div\", [h(\"Tag\", {\n              props: {\n                color: \"red\"\n              }\n            }, \"弃用\")]);\n          }\n        }\n      }, {\n        title: \"创建时间\",\n        key: \"createTime\",\n        align: \"center\",\n        width: 180,\n        sortable: true,\n        sortType: \"desc\"\n      }, {\n        title: \"更新时间\",\n        key: \"updateTime\",\n        align: \"center\",\n        width: 180,\n        sortable: true\n      }, {\n        title: \"操作\",\n        key: \"action\",\n        align: \"center\",\n        width: 300,\n        render: function render(h, params) {\n          var enableOrDisable = \"\";\n          var showButton = \"\";\n          var editButton = h(\"Button\", {\n            props: {\n              type: \"primary\",\n              size: \"small\",\n              disabled: !_this.$route.meta.permTypes.includes('edit')\n            },\n            style: {\n              marginRight: \"5px\"\n            },\n            on: {\n              click: function click() {\n                _this.openEditDialog(params.row);\n              }\n            }\n          }, \"编辑\");\n\n          if (params.row.status == 0) {\n            enableOrDisable = h(\"Button\", {\n              props: {\n                size: \"small\",\n                disabled: !_this.$route.meta.permTypes.includes('disable')\n              },\n              style: {\n                marginRight: \"5px\"\n              },\n              on: {\n                click: function click() {\n                  _this.disable(params.row);\n                }\n              }\n            }, \"禁用\");\n          } else {\n            enableOrDisable = h(\"Button\", {\n              props: {\n                type: \"success\",\n                size: \"small\",\n                disabled: !_this.$route.meta.permTypes.includes('enable')\n              },\n              style: {\n                marginRight: \"5px\"\n              },\n              on: {\n                click: function click() {\n                  _this.enable(params.row);\n                }\n              }\n            }, \"启用\");\n          }\n\n          ;\n          var setDefaultButton = \"\";\n\n          if (params.row.parentId == \"0\") {\n            showButton = h(\"Button\", {\n              props: {\n                type: \"info\",\n                size: \"small\"\n              },\n              style: {\n                marginRight: \"5px\"\n              },\n              on: {\n                click: function click() {\n                  _this.openShowDialog(params.row);\n                }\n              }\n            }, \"查看\");\n            setDefaultButton = h(\"Button\", {\n              props: {\n                type: \"info\",\n                size: \"small\",\n                disabled: _this.currServer.id == params.row.id\n              },\n              style: {\n                marginRight: \"5px\"\n              },\n              on: {\n                click: function click() {\n                  _this.setDefault(params.row);\n                }\n              }\n            }, \"设为操作服\");\n          }\n\n          return h(\"div\", [showButton, editButton, enableOrDisable, setDefaultButton]);\n        }\n      }],\n      data: [],\n      childrenData: [],\n      serverForm: {\n        name: \"\",\n        address: \"\",\n        port: \"\",\n        parentId: \"0\"\n      },\n      viewServer: {},\n      sortColumn: \"createTime\",\n      sortType: \"desc\",\n      pageNumber: 1,\n      pageSize: 10,\n      total: 0\n    };\n  },\n  methods: {\n    init: function init() {\n      this.getServerByPage();\n      this.getDefault();\n    },\n    getServerByPage: function getServerByPage() {\n      var _this2 = this;\n\n      var params = {\n        pageNumber: this.pageNumber,\n        pageSize: this.pageSize,\n        sort: this.sortColumn,\n        order: this.sort\n      };\n      this.loading = true;\n\n      _getServerByPage(params).then(function (res) {\n        _this2.loading = false;\n\n        if (res.success) {\n          _this2.data = res.result.records;\n          _this2.total = res.result.total;\n\n          if (res.result.content || res.result.totalElements) {\n            _this2.data = res.result.content;\n            _this2.total = res.result.totalElements;\n          }\n        }\n      });\n    },\n    refresh: function refresh() {\n      if (this.viewDialogFormVisible) {\n        this.getServerListByParentId();\n      } else {\n        this.getServerByPage();\n      }\n    },\n    addServer: function addServer() {\n      var _this3 = this;\n\n      if (!this.checkFormData()) {\n        return;\n      }\n\n      _addServer(this.serverForm).then(function (res) {\n        if (res.success) {\n          _this3.hideAddDialog();\n\n          _this3.refresh();\n        }\n      });\n    },\n    editServer: function editServer() {\n      var _this4 = this;\n\n      if (!this.checkFormData()) {\n        return;\n      }\n\n      updateServer(this.serverForm).then(function (res) {\n        if (res.success) {\n          _this4.hideAddDialog();\n\n          _this4.refresh();\n        }\n      });\n    },\n    checkFormData: function checkFormData() {\n      if (!this.serverForm.name) {\n        this.$Message.error(\"请输入服务器名称\");\n        return false;\n      }\n\n      if (!this.serverForm.address) {\n        this.$Message.error(\"请输入服务器地址\");\n        return false;\n      }\n\n      if (!this.serverForm.port) {\n        this.serverForm.port = 80;\n      }\n\n      return true;\n    },\n    clearSelectAll: function clearSelectAll() {\n      this.$refs.table.selectAll(false);\n    },\n    changeSelect: function changeSelect(e) {\n      this.selectList = e;\n      this.selectCount = e.length;\n    },\n    changePage: function changePage(v) {\n      this.pageNumber = v;\n      this.getServerByPage();\n      this.clearSelectAll();\n    },\n    changePageSize: function changePageSize(v) {\n      this.pageSize = v;\n      this.getServerByPage();\n    },\n    changeSort: function changeSort(e) {\n      this.sortColumn = e.key;\n      this.sortType = e.order;\n\n      if (e.order == \"normal\") {\n        this.sortType = \"\";\n      }\n\n      this.getServerByPage();\n    },\n    openAddDialog: function openAddDialog() {\n      this.dialogFormTitle = '添加服务器';\n      this.serverForm = {};\n      this.serverForm.parentId = \"0\";\n      this.isEdit = false;\n      this.dialogFormVisible = true;\n    },\n    hideAddDialog: function hideAddDialog() {\n      this.dialogFormVisible = false;\n      this.refresh();\n    },\n    openAddDialogWithChildren: function openAddDialogWithChildren() {\n      this.openAddDialog();\n      this.dialogFormTitle = '添加子服务器';\n      this.serverForm.parentId = this.viewServer.id;\n    },\n    hideViewDialog: function hideViewDialog() {\n      this.viewDialogFormVisible = false;\n      this.getServerByPage();\n    },\n    openShowDialog: function openShowDialog(scopeRow) {\n      this.viewServer = scopeRow;\n      this.getServerListByParentId();\n      this.viewDialogFormVisible = true;\n    },\n    getServerListByParentId: function getServerListByParentId() {\n      var _this5 = this;\n\n      _getServerListByParentId({\n        parentId: this.viewServer.id\n      }).then(function (res) {\n        if (res.success) {\n          _this5.childrenData = res.result;\n        }\n      });\n    },\n    openEditDialog: function openEditDialog(scopeRow) {\n      this.dialogFormTitle = '修改服务器';\n      this.isEdit = true;\n      this.serverForm = scopeRow;\n      this.dialogFormVisible = true;\n    },\n    enable: function enable(v) {\n      var _this6 = this;\n\n      this.$Modal.confirm({\n        title: \"确认启用\",\n        content: \"您确认要启用服务器 \" + v.name + \" ?\",\n        loading: true,\n        onOk: function onOk() {\n          enableServer({\n            id: v.id\n          }).then(function (res) {\n            _this6.$Modal.remove();\n\n            if (res.success) {\n              _this6.$Message.success(\"操作成功\");\n\n              _this6.refresh();\n            }\n          });\n        }\n      });\n    },\n    disable: function disable(v) {\n      var _this7 = this;\n\n      this.$Modal.confirm({\n        title: \"确认禁用\",\n        content: \"您确认要禁用服务器 \" + v.name + \" ?\",\n        loading: true,\n        onOk: function onOk() {\n          disableServer({\n            id: v.id\n          }).then(function (res) {\n            _this7.$Modal.remove();\n\n            if (res.success) {\n              _this7.$Message.success(\"操作成功\");\n\n              _this7.refresh();\n            }\n          });\n        }\n      });\n    },\n    setDefault: function setDefault(v) {\n      var _this8 = this;\n\n      this.$Modal.confirm({\n        title: \"确认设置\",\n        content: \"您确认要 \" + v.name + \" 为默认操作服务器?\",\n        loading: true,\n        onOk: function onOk() {\n          setDefaultServer({\n            id: v.id\n          }).then(function (res) {\n            _this8.$Modal.remove();\n\n            if (res.success) {\n              _this8.$Message.success(res.message);\n            } else {\n              _this8.$Message.error(res.message);\n            }\n\n            _this8.getDefault();\n          });\n        }\n      });\n    },\n    getDefault: function getDefault() {\n      var _this9 = this;\n\n      this.currServer = \"\";\n      getDefaultServer().then(function (res) {\n        if (res.success) {\n          _this9.currServer = res.result;\n        }\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.init();\n  }\n};",null]}