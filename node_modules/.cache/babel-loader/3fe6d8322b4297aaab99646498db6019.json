{"remainingRequest":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/game/notice/notice.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/game/notice/notice.vue","mtime":1574132205000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getNoticeListData, addNotice as _addNotice, deleteNotice as _deleteNotice, editNotice as _editNotice } from \"@/api/index\";\nimport util from \"../../../libs/util\";\nexport default {\n  name: \"notice\",\n  data: function data() {\n    var _this = this;\n\n    return {\n      loading: false,\n      page: {\n        per_page: 10,\n        cur_page: 1,\n        total: 0\n      },\n      formTypeStrMaxlength: 6,\n      formTitleMaxlength: 20,\n      notices: [],\n      columns: [{\n        type: \"index\",\n        width: 60,\n        align: \"center\"\n      }, {\n        title: \"公告ID\",\n        key: \"id\",\n        width: 80\n      }, {\n        title: \"发布时间\",\n        key: \"publishTime\",\n        width: 110,\n        align: \"center\",\n        render: function render(h, params) {\n          return h(\"div\", util.Time2DefaultFormat(params.row.publishTime));\n        }\n      }, {\n        title: \"开始时间\",\n        key: \"startTime\",\n        width: 110,\n        align: \"center\",\n        render: function render(h, params) {\n          return h(\"div\", util.Time2DefaultFormat(params.row.startTime));\n        }\n      }, {\n        title: \"结束时间\",\n        key: \"endTime\",\n        width: 110,\n        align: \"center\",\n        render: function render(h, params) {\n          return h(\"div\", util.Time2DefaultFormat(params.row.endTime));\n        }\n      }, {\n        title: \"跳转\",\n        key: \"frontSkipPos\",\n        width: 80,\n        align: \"center\"\n      }, {\n        title: \"跳转图片\",\n        key: \"skipImg\",\n        width: 110,\n        align: \"center\"\n      }, {\n        title: \"标题\",\n        key: \"title\",\n        width: 80,\n        align: \"center\"\n      }, {\n        title: \"公告类型\",\n        key: \"typeStr\",\n        width: 100,\n        align: \"center\"\n      }, {\n        title: \"优先级\",\n        key: \"priority\",\n        width: 100,\n        align: \"center\"\n      }, {\n        title: \"内容\",\n        key: \"content\",\n        width: 200,\n        align: \"center\"\n      }, {\n        title: \"操作\",\n        key: \"action\",\n        width: 200,\n        align: \"center\",\n        render: function render(h, params) {\n          return h(\"div\", [h(\"Button\", {\n            props: {\n              type: \"info\",\n              size: \"small\"\n            },\n            on: {\n              click: function click() {\n                _this.openEditDialog(params.row);\n              }\n            }\n          }, \"编辑\"), h(\"Button\", {\n            props: {\n              type: \"error\",\n              size: \"small\"\n            },\n            on: {\n              click: function click() {\n                _this.deleteNotice(params.row.id);\n              }\n            }\n          }, \"删除\")]);\n        }\n      }],\n      dialogFormVisible: false,\n      dialogFormTitle: '',\n      isEdit: false,\n      form: {\n        id: -1,\n        title: '',\n        typeStr: '',\n        priority: '',\n        titleImg: '',\n        adImg: '',\n        duration: [],\n        content: '',\n        frontSkipPos: '',\n        skipImg: ''\n      },\n      disabledDate: {\n        disabledDate: function disabledDate(date) {\n          return date.getTime() < new Date(new Date().toLocaleDateString()).getTime();\n        }\n      }\n    };\n  },\n  methods: {\n    init: function init() {\n      this.getNotices();\n    },\n    getNotices: function getNotices() {\n      var _this2 = this;\n\n      getNoticeListData(this.page).then(function (res) {\n        _this2.notices = res.data.notices;\n        _this2.page.total = res.data.total;\n      });\n    },\n    openAddDialog: function openAddDialog() {\n      this.clearFrom();\n      this.dialogFormTitle = '添加游戏公告';\n      this.isEdit = false;\n      this.dialogFormVisible = true;\n    },\n    hideAddDialog: function hideAddDialog() {\n      this.clearFrom();\n      this.dialogFormVisible = false;\n      this.getNotices();\n    },\n    openEditDialog: function openEditDialog(scopeRow) {\n      this.clearFrom();\n      this.dialogFormTitle = '修改游戏公告';\n      this.isEdit = true;\n      this.form.id = scopeRow.id;\n      this.dialogFormVisible = true;\n      this.form.title = scopeRow.title;\n      this.form.typeStr = scopeRow.typeStr;\n      this.form.priority = scopeRow.priority;\n      this.form.titleImg = scopeRow.titleImg;\n      this.form.adImg = scopeRow.adImg;\n      this.form.duration.push(new Date(scopeRow.startTime));\n      this.form.duration.push(new Date(scopeRow.endTime));\n      this.form.content = scopeRow.content;\n      this.form.frontSkipPos = scopeRow.frontSkipPos;\n      this.form.skipImg = scopeRow.skipImg;\n    },\n    clearFrom: function clearFrom() {\n      this.form.id = -1;\n      this.form.title = '';\n      this.form.typeStr = '';\n      this.form.priority = '';\n      this.form.titleImg = '';\n      this.form.adImg = '';\n      this.form.duration = [];\n      this.form.content = '';\n      this.form.frontSkipPos = '';\n      this.form.skipImg = '';\n    },\n    checkFrom: function checkFrom() {\n      var _this3 = this;\n\n      if (this.form.duration.length !== 2) {\n        this.$Message.error('请选择时间');\n        return false;\n      }\n\n      if (!this.form.title || !this.form.typeStr || !this.form.priority || !this.form.content || !this.form.frontSkipPos) {\n        this.$Message.error('参数异常');\n        return false;\n      }\n\n      if (this.form.title.length > 20 || this.form.typeStr.length > 6) {\n        this.$Message.error('长度过长');\n        return false;\n      }\n\n      this.form.duration.forEach(function (item, index) {\n        _this3.form.duration[index] = item.getTime();\n      });\n      return true;\n    },\n    addNotice: function addNotice() {\n      var _this4 = this;\n\n      if (!this.checkFrom()) {\n        return;\n      }\n\n      _addNotice(this.form).then(function (res) {\n        _this4.hideAddDialog();\n\n        if (res.status === 200) {\n          _this4.$Message.success('添加成功');\n        }\n      });\n    },\n    editNotice: function editNotice() {\n      var _this5 = this;\n\n      _editNotice(this.form).then(function (res) {\n        _this5.hideAddDialog();\n\n        if (res.status === 200) {\n          _this5.$Message.success('修改成功');\n        }\n      });\n    },\n    deleteNotice: function deleteNotice(id) {\n      var _this6 = this;\n\n      _deleteNotice({\n        id: id\n      }).then(function (res) {\n        if (res.status === 200) {\n          _this6.$Message.success('删除成功');\n        }\n\n        _this6.getNotices();\n      });\n    },\n    changePage: function changePage(v) {\n      this.page.cur_page = v;\n      this.getNotices();\n    },\n    changePageSize: function changePageSize(v) {\n      this.page.per_page = v;\n      this.getNotices();\n    }\n  },\n  mounted: function mounted() {\n    this.init();\n  }\n};",{"version":3,"sources":["notice.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"search\">\n    <Row>\n      <Button @click=\"getNotices\">查询</Button>\n      <Button @click='openAddDialog'>添加</Button>\n    </Row>\n    <Row>\n      <Table :loading=\"loading\" border :columns=\"columns\" :data=\"notices\" ref=\"table\"></Table>\n    </Row>\n    <Row>\n      <Modal :title=dialogFormTitle v-model=\"dialogFormVisible\" :mask-closable=\"false\" width=\"50%\">\n        <Form :model=\"form\" :label-width=\"120\">\n\n          <FormItem label=\"公告起止时间\">\n            <DatePicker v-model=\"form.duration\"\n                        type=\"datetimerange\"\n                        format=\"yyyy-MM-dd HH:mm:ss\"\n                        placeholder=\"请选择时间日期\"\n                        style=\"width: 50%;max-width: 350px\"\n                        :options=\"disabledDate\">\n            </DatePicker>\n          </FormItem>\n\n          <FormItem label=\"公告类型\">\n            <Input v-model=\"form.typeStr\" autocomplete=\"off\" placeholder=\"请输入公告类型，最大输入6字\" :maxlength=\"formTypeStrMaxlength\"/>\n          </FormItem>\n\n          <FormItem label=\"标题\" >\n            <Input v-model=\"form.title\" autocomplete=\"off\" placeholder=\"请输入标题，最大输入20字\" :maxlength=\"formTitleMaxlength\"/>\n          </FormItem>\n\n          <FormItem label=\"跳转\" >\n            <Input v-model=\"form.frontSkipPos\" autocomplete=\"off\" placeholder=\"请输入跳转\"/>\n          </FormItem>\n\n          <FormItem label=\"优先级\" >\n            <Input v-model=\"form.priority\" autocomplete=\"off\" placeholder=\"请输入优先级\"/>\n          </FormItem>\n\n          <FormItem label=\"内容\"  style=\"height: 100px\">\n            <Input v-model=\"form.content\" autocomplete=\"off\" type=\"textarea\" placeholder=\"请输入公告内容\"\n                      :autosize=\"{ minRows: 2, maxRows: 5}\"/>\n          </FormItem>\n\n          <FormItem label=\"标题图片\" >\n            <Input v-model=\"form.titleImg\" autocomplete=\"off\" placeholder=\"请输入标题图片链接\"/>\n          </FormItem>\n\n          <FormItem label=\"广告图片\" >\n            <Input v-model=\"form.adImg\" autocomplete=\"off\" placeholder=\"请输入广告图片链接\"/>\n          </FormItem>\n\n          <FormItem label=\"跳转后界面图片\" >\n            <Input v-model=\"form.skipImg\" autocomplete=\"off\" placeholder=\"请输入跳转图片链接\"/>\n          </FormItem>\n        </Form>\n        <div slot=\"footer\">\n          <Button @click=\"hideAddDialog()\">取 消</Button>\n          <Button type=\"primary\" @click=\"addNotice()\" v-show=\"!isEdit\">确定添加</Button>\n          <Button type=\"primary\" @click=\"editNotice()\" v-show=\"isEdit\">确定修改</Button>\n        </div>\n      </Modal>\n    </Row>\n    <Row type=\"flex\" justify=\"end\" class=\"page\">\n      <Page\n              :current=\"page.cur_page\"\n              :total=\"page.total\"\n              :page-size=\"page.per_page\"\n              @on-change=\"changePage\"\n              @on-page-size-change=\"changePageSize\"\n              :page-size-opts=\"[10,20,50]\"\n              size=\"small\"\n              show-total\n              show-elevator\n              show-sizer\n      ></Page>\n    </Row>\n  </div>\n\n</template>\n\n<script>\n    import {\n        getNoticeListData,\n        addNotice,\n        deleteNotice,\n        editNotice\n    } from \"@/api/index\";\n    import util from \"../../../libs/util\";\n\n    export default {\n        name: \"notice\",\n        data() {\n            return {\n                loading: false,\n                page: {\n                    per_page: 10,\n                    cur_page: 1,\n                    total: 0\n                },\n                formTypeStrMaxlength:6,\n                formTitleMaxlength: 20,\n                notices: [],\n                columns: [\n                    {type: \"index\", width: 60, align: \"center\"},\n                    {title: \"公告ID\", key: \"id\", width: 80},\n                    {title: \"发布时间\", key: \"publishTime\", width: 110, align: \"center\",render: (h, params) => {return h(\"div\", util.Time2DefaultFormat(params.row.publishTime))}},\n                    {title: \"开始时间\", key: \"startTime\", width: 110, align: \"center\",render: (h, params) => {return h(\"div\", util.Time2DefaultFormat(params.row.startTime))}},\n                    {title: \"结束时间\", key: \"endTime\", width: 110, align: \"center\",render: (h, params) => {return h(\"div\", util.Time2DefaultFormat(params.row.endTime))}},\n                    {title: \"跳转\", key: \"frontSkipPos\", width: 80, align: \"center\",},\n                    {title: \"跳转图片\", key: \"skipImg\", width: 110, align: \"center\",},\n                    {title: \"标题\", key: \"title\", width: 80, align: \"center\",},\n                    {title: \"公告类型\", key: \"typeStr\", width: 100, align: \"center\",},\n                    {title: \"优先级\", key: \"priority\", width: 100, align: \"center\",},\n                    {title: \"内容\", key: \"content\", width: 200, align: \"center\",},\n                    {title: \"操作\", key: \"action\", width: 200, align: \"center\",\n                        render: (h, params) => {\n                            return h(\"div\", [\n                                h(\"Button\", {props: {type: \"info\", size: \"small\"}, on: {click: () => {this.openEditDialog(params.row);}}}, \"编辑\"),\n                                h(\"Button\", {props: {type: \"error\", size: \"small\"}, on: {click: () => {this.deleteNotice(params.row.id);}}}, \"删除\")]);\n                        }\n                    }],\n                dialogFormVisible: false,\n                dialogFormTitle: '',\n                isEdit: false,\n                form: {\n                    id: -1,\n                    title: '',\n                    typeStr: '',\n                    priority: '',\n                    titleImg: '',\n                    adImg: '',\n                    duration: [],\n                    content: '',\n                    frontSkipPos: '',\n                    skipImg: ''\n                },\n                disabledDate: {\n                    disabledDate(date) {\n                        return date.getTime() < new Date(new Date().toLocaleDateString()).getTime();\n                    }\n                }\n            }\n        },\n        methods: {\n            init() {\n                this.getNotices();\n            },\n            getNotices() {\n                getNoticeListData(this.page).then(res => {\n                    this.notices = res.data.notices;\n                    this.page.total = res.data.total;\n                });\n            },\n            openAddDialog() {\n                this.clearFrom();\n                this.dialogFormTitle = '添加游戏公告';\n                this.isEdit = false;\n                this.dialogFormVisible = true;\n            },\n            hideAddDialog() {\n                this.clearFrom();\n                this.dialogFormVisible = false;\n                this.getNotices();\n            },\n            openEditDialog(scopeRow) {\n                this.clearFrom();\n                this.dialogFormTitle = '修改游戏公告';\n                this.isEdit = true;\n                this.form.id = scopeRow.id;\n                this.dialogFormVisible = true;\n                this.form.title = scopeRow.title;\n                this.form.typeStr = scopeRow.typeStr;\n                this.form.priority = scopeRow.priority;\n                this.form.titleImg = scopeRow.titleImg;\n                this.form.adImg = scopeRow.adImg;\n                this.form.duration.push(new Date(scopeRow.startTime));\n                this.form.duration.push(new Date(scopeRow.endTime));\n                this.form.content = scopeRow.content;\n                this.form.frontSkipPos = scopeRow.frontSkipPos;\n                this.form.skipImg = scopeRow.skipImg;\n            },\n            clearFrom() {\n                this.form.id = -1;\n                this.form.title = '';\n                this.form.typeStr = '';\n                this.form.priority = '';\n                this.form.titleImg = '';\n                this.form.adImg = '';\n                this.form.duration = [];\n                this.form.content = '';\n                this.form.frontSkipPos = '';\n                this.form.skipImg = '';\n            },\n            checkFrom() {\n                if (this.form.duration.length !== 2) {\n                    this.$Message.error('请选择时间');\n                    return false;\n                }\n                if (!this.form.title || !this.form.typeStr || !this.form.priority || !this.form.content || !this.form.frontSkipPos) {\n                    this.$Message.error('参数异常');\n                    return false;\n                }\n                if (this.form.title.length > 20 || this.form.typeStr.length > 6) {\n                    this.$Message.error('长度过长');\n                    return false;\n                }\n                this.form.duration.forEach((item, index) => {\n                    this.form.duration[index] = item.getTime();\n                });\n                return true;\n            },\n            addNotice() {\n                if (!this.checkFrom()) {\n                    return;\n                }\n                addNotice(this.form).then(res=>{\n                    this.hideAddDialog();\n                    if (res.status === 200){\n                        this.$Message.success('添加成功');\n                    }\n                });\n            },\n            editNotice() {\n                editNotice(this.form).then(res=>{\n                    this.hideAddDialog();\n                    if (res.status === 200){\n                        this.$Message.success('修改成功');\n                    }\n                });\n            },\n            deleteNotice(id) {\n                deleteNotice({id:id}).then(res=>{\n                    if (res.status === 200){\n                        this.$Message.success('删除成功');\n                    }\n                    this.getNotices();\n                });\n            },\n            changePage(v) {\n                this.page.cur_page = v;\n                this.getNotices();\n            },\n            changePageSize(v) {\n                this.page.per_page = v;\n                this.getNotices();\n            }\n        },\n        mounted() {\n            this.init();\n        }\n\n    }\n</script>\n\n<style scoped>\n\n</style>\n"],"sourceRoot":"src/views/game/notice"}]}